<% wrap_layout :layout do %>
<article class="page">
  <h1 class="page-header">
    <% if content_for?(:title) %>
      <%= yield_content(:title) %>
    <% else %>
      <%= h(current_page.title) %>
    <% end %>
  </h1>

  <div>
    <% if current_page.category %>
      [<%= link_to(h(current_page.category), "/categories.html\#" + current_page.category ) %>]
    <% end %>
    <%= current_page.mtime.strftime("%d %b %Y %H:%M:%S %Z") %>
    <%= current_page.prose_edit_link(data.config.site_info.github, "site") %>
    <%= share_twitter(data.config.site_info.twitter) %>
  </div>
  <div class="content">
    <%= yield %>
  </div>
  <hr>
  <section class="page_footer">
    <ul class="tag_box inline">
      <li>tag:</li>
      <% tags.each do |tag, pages| %>
        <% caption = "%{tag} <span>%{count}</span>" % {tag: h(tag), count: pages.count} %>
        <li><%= link_to(caption, "/tags.html#" + h(tag)) %></li>
      <% end %>
    </ul>
  </section>
  <hr>
  <h2>debug</h2>
  <% page = current_page %>
  <ul>
    <li>source_file: <%= h page.source_file %>
    <li>path: <%= h page.path %>
    <li>destination_path: <%= h page.destination_path %>
    <li>url: <%= h page.url %>
    <li>data.class: <%= h page.data.class %>
    <li>data: <%= h page.data %>
    <li>data(hashed): <%= h page.data.to_hash %>
    <li>data.title: <%= h page.data.title %>
    <li>.root <%= Middleman::Application.root %>
    <li>.root_path <%= Middleman::Application.root_path %>
  </ul>
</article>
<% end %>

