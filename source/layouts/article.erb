<% wrap_layout :layout do %>
<article>
  <header>
    <h1>
      <% if content_for?(:title) %>
      <%= yield_content(:title) %>
      <% else %>
      <%= h(current_article.title) %>
      <% end %>
    </h1>

    <section class="page_info">
      <%= page_info(current_article) %>
    </section>
  </header>

  <hr>

  <section class="page_content">
    <%= yield %>
  </section>

  <hr>

  <footer>
    <ul class="tag_box inline">
      <% blog.tags.each do |tag, pages| %>
        <% if current_article.tags.include? tag %>
          <li>
	    <% caption = "%{tag} <span>%{count}</span>" % {tag: h(tag), count: pages.count} %>
            <%= link_to(caption, "/tags.html#" + h(tag)) %>
	  </li>
	<% end %>
      <% end %>
    </ul>
  </footer>
<!-- 
  <h2>debug</h2>
  <% page = current_article %>
  <ul>
    <li>source_file: <%= h page.source_file %>
    <li>path: <%= h page.path %>
    <li>destination_path: <%= h page.destination_path %>
    <li>url: <%= h page.url %>
    <li>data.class: <%= h page.data.class %>
    <li>data: <%= h page.data %>
    <li>data(hashed): <%= h page.data.to_hash %>
    <li>data.title: <%= h page.data.title %>
    <li>.root <%= Middleman::Application.root %>
    <li>.root_path <%= Middleman::Application.root_path %>
  </ul>
-->
</article>
<% end %>

