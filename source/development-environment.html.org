---
title: 開発環境のセットアップ
layout: article
---

** 仮想OSのインストール

http://dotinstall.com/lessons/basic_local_development_v2/24803 を参考に。

*** VirtualBox, Vigrant

VirtualBox と Vigrant をwindows上にインストール。

- virtualbox: https://www.virtualbox.org/wiki/Downloads
- vigrant: http://www.vagrantup.com/downloads.html

box を持ってきて加える：

centos6.4:

#+BEGIN_SRC 
% vagrant box add centos64box http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20131103.box
% vagrant init centos64box
#+END_SRC

centos6.5:


#+BEGIN_SRC 
% vagrant box add centos65box https://github.com/2creatives/vagrant-centos/releases/download/v6.5.3/centos65-x86_64-20140116.box
% vagrant init centos65box
#+END_SRC

vi Vagrantfile で private_network 部分のコメントアウトを外す

#+BEGIN_SRC 
  # Create a private network, which allows host-only access to the machine
  # using a specific IP.
   config.vm.network "private_network", ip: "192.168.33.10"
#+END_SRC

そして up, ssh

#+BEGIN_SRC 
% vagrant up （時間かかる）
% vagrant ssh
#+END_SRC

ホスト側から % ssh vagrant@193.168.33.10 を確かめる

** 開発環境
*** 最新にアップデート

```
% sudo yum update -y （時間かかる）
...
% suco echo "options single-request-reopen" >> /etc/resolv.conf
% sudo service iptables stop
% sudo chkconfig iptables off
```

## ruby のインストール
rbenv でruby のヴァージョンを切り替える
% sudo yum install git -y

https://github.com/sstephenson/rbenv にあるとおりやる。

```
% git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
% echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
% echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
open new terminal
% rbenv

% git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
% rbenv install 2.1.4
% rbenv rehash
% rbenv global 2.1.4
% rbenv versions
```

- 1.9.3-p547
- 2.0.0-p594
- 2.1.4

% sudo yum install ruby-devel もしておく。

### 参考：ruby1.9.x を rpm

http://park1.wakwak.com/~ima/centos_ruby0001.html


## その他開発環境のセットアップ

### yum install 
n
- git

### gems
bundle である程度一通り：

```
% vi Gemfile
source 'https://rubygems.org'

gem 'rack'
gem 'activerecord'
gem 'actionview'

gem 'sinatra'
gem 'sinatra-activerecord'
gem 'sinatra-contrib'
gem 'sinatra-reloader'

gem 'sqlite3'
% bundle install

```

## rails

% vi Gemfile
gem 'therubyracer'	←追加
% bundle install

## sinatra を外部から叩く
development だと local しか listen しないので、production にする：
http://qiita.com/u1_fukui/items/b86b21f6ed39f4c10d5d

set :environment, :production

か

set :bind, '0.0.0.0'

をコードに入れる。

## ウェブサーバーの立ち上げ
```
% sudo yum install httpd -y
% sudo yum service httpd start
% sud yum chkconfig httpd on
```

ホスト側から http://193.168.33.10/ を確認

## 共有フォルダ

hostで Vagrantfile があるディレクトリ（~/vagrant/centos64とする）が仮想側の /vagrant と共有されるので、
元ソースを host:~/vagrant/centos64/source におき、guest:~/ で

```
% cd ~/; ln -s /vagrant/source .
```

とすると、host 側の ~/vagrant/centos64/source/*を emacs で編集しつつ guest 側の ~/source で参照することができる。



